<%- include('partials/header', { activePage: 'ledger' }) %>

    <div class="mb-8 flex justify-between items-center">
        <h1 class="text-3xl font-bold text-gray-900">Ledger & Financials</h1>
        <div class="flex space-x-2">
            <button
                class="bg-white hover:bg-gray-50 text-satelink-text border border-satelink-border px-4 py-2 rounded-lg text-sm font-bold shadow-sm transition-colors flex items-center">
                <%- include('partials/icon', { name: 'file-export' , className: 'w-4 h-4 mr-2 text-satelink-muted' }) %>
                    Export CSV
            </button>
        </div>
    </div>

    <div class="bg-white rounded-2xl border border-satelink-border shadow-sm overflow-hidden">
        <div class="p-6 border-b border-satelink-border bg-gray-50/50">
            <h3 class="font-bold text-lg text-gray-900">Distribution History</h3>
        </div>
        <div class="overflow-x-auto">
            <table class="w-full text-left text-sm">
                <thead class="bg-gray-50 text-satelink-muted font-medium border-b border-satelink-border">
                    <tr>
                        <th class="px-6 py-3 font-semibold">Epoch ID</th>
                        <th class="px-6 py-3 font-semibold">Date</th>
                        <th class="px-6 py-3 font-semibold">Total Rev</th>
                        <th class="px-6 py-3 font-semibold">Platform Fee</th>
                        <th class="px-6 py-3 font-semibold">Node Pool</th>
                        <th class="px-6 py-3 font-semibold text-right">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                    <% if(runs.length===0) { %>
                        <tr>
                            <td colspan="6" class="px-6 py-8 text-center text-satelink-muted italic">No distribution
                                runs recorded yet.</td>
                        </tr>
                        <% } %>
                            <% runs.forEach(r=> { %>
                                <tr class="hover:bg-gray-50 transition-colors">
                                    <td class="px-6 py-4 font-bold text-gray-900">#<%= r.epoch_id %>
                                    </td>
                                    <td class="px-6 py-4 text-gray-600">
                                        <%= formatDate(r.created_at * 1000) %>
                                    </td>
                                    <td class="px-6 py-4 text-satelink-success font-bold">
                                        <%= formatCurrency(r.total_revenue) %>
                                    </td>
                                    <td class="px-6 py-4 text-gray-600">
                                        <%= formatCurrency(r.platform_fee) %>
                                    </td>
                                    <td class="px-6 py-4 text-satelink-accent font-bold">
                                        <%= formatCurrency(r.node_pool) %>
                                    </td>
                                    <td class="px-6 py-4 text-right">
                                        <button
                                            class="text-satelink-muted hover:text-gray-900 p-1 rounded hover:bg-slate-100 transition-colors">
                                            <%- include('partials/icon', { name: 'ellipsis-h' , className: 'w-4 h-4' })
                                                %>
                                        </button>
                                    </td>
                                </tr>
                                <% }) %>
                </tbody>
            </table>
        </div>
    </div>

    <%- include('partials/footer') %>