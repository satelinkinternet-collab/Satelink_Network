# ============================================================
# Satelink Network — Environment Configuration Template
# ============================================================
# Copy to .env and fill in all values marked REQUIRED
# NEVER commit your actual .env to git
#
# Generate secure secrets:
#   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
# ============================================================

# ─── Application ─────────────────────────────────────────────
NODE_ENV=development           # development | staging | production
PORT=3001
API_BASE_URL=http://localhost:3001
FRONTEND_URL=http://localhost:3000
LOG_LEVEL=info                 # debug | info | warn | error

# ─── JWT Secrets (REQUIRED — no fallbacks ever) ──────────────
# Must be min 32 chars, recommended 64+ chars (512-bit entropy)
# Generate: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=REPLACE_WITH_64_CHAR_HEX_SECRET_REQUIRED
JWT_REFRESH_SECRET=REPLACE_WITH_DIFFERENT_64_CHAR_HEX_SECRET_REQUIRED
JWT_TTL=15m
JWT_REFRESH_TTL=7d
JWT_ISSUER=satelink-network

# ─── Database ─────────────────────────────────────────────────
DB_TYPE=postgres               # postgres | sqlite (sqlite for dev ONLY)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=satelink
DB_USER=satelink_app
DB_PASSWORD=REPLACE_WITH_STRONG_DB_PASSWORD_REQUIRED
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_SSL=false                   # Set true in production with valid cert

# SQLite (development only — do NOT use in production)
SQLITE_PATH=./data/satelink-dev.db

# ─── Blockchain / Smart Contracts ────────────────────────────
# Fuse Network
FUSE_RPC_URL=https://rpc.fuse.io
FUSE_CHAIN_ID=122
FUSE_USDT_CONTRACT=REPLACE_WITH_DEPLOYED_FUSE_USDT_ADDRESS
NODE_REGISTRY_CONTRACT=REPLACE_WITH_DEPLOYED_NODE_REGISTRY_ADDRESS
REVENUE_VAULT_CONTRACT=REPLACE_WITH_DEPLOYED_REVENUE_VAULT_ADDRESS
CLAIMS_CONTRACT=REPLACE_WITH_DEPLOYED_CLAIMS_CONTRACT_ADDRESS
REVENUE_DISTRIBUTOR_CONTRACT=REPLACE_WITH_DEPLOYED_DISTRIBUTOR_ADDRESS

# Testnet (for staging/testing)
FUSE_SPARK_RPC_URL=https://rpc.fusespark.io
FUSE_SPARK_CHAIN_ID=123
FUSE_SPARK_USDT_CONTRACT=REPLACE_WITH_TESTNET_USDT_ADDRESS

# ─── Settlement Engine ────────────────────────────────────────
SETTLEMENT_ADAPTER=simulated   # simulated | shadow | evm
SETTLEMENT_BATCH_SIZE=50
SETTLEMENT_RETRY_ATTEMPTS=3
SETTLEMENT_RETRY_DELAY_MS=5000
# CRITICAL: Use KMS or hardware wallet in production, NOT raw private key
# For production use AWS KMS: SETTLEMENT_KMS_KEY_ARN=arn:aws:kms:...
SETTLEMENT_EVM_SIGNER_PRIVATE_KEY=REPLACE_WITH_SIGNER_KEY_NEVER_USE_IN_PROD_USE_KMS

# ─── Redis / Cache ────────────────────────────────────────────
REDIS_URL=redis://localhost:6379
REDIS_PREFIX=satelink:
REDIS_TTL_SECONDS=3600

# ─── Heartbeat & Telemetry ────────────────────────────────────
HEARTBEAT_INTERVAL_SECONDS=30
HEARTBEAT_MAX_DRIFT_SECONDS=10
HEARTBEAT_MISS_THRESHOLD=3
TELEMETRY_RETENTION_DAYS=90

# ─── Epoch Engine ─────────────────────────────────────────────
EPOCH_DURATION_HOURS=24
EPOCH_FINALIZATION_DELAY_HOURS=2
CLAIM_WINDOW_DAYS=48

# ─── Operations & Pricing ────────────────────────────────────
OPS_RATE_LIMIT_WINDOW_MS=60000
OPS_RATE_LIMIT_MAX=100
OPS_DEFAULT_PRICE_USDT=0.001

# ─── MoonPay (Fiat On/Off-ramp) ──────────────────────────────
MOONPAY_API_KEY=REPLACE_WITH_MOONPAY_API_KEY
MOONPAY_SECRET_KEY=REPLACE_WITH_MOONPAY_SECRET
MOONPAY_WEBHOOK_SECRET=REPLACE_WITH_MOONPAY_WEBHOOK_SECRET
MOONPAY_BASE_URL=https://api.moonpay.com

# ─── Email / Notifications ────────────────────────────────────
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=REPLACE_WITH_SMTP_PASSWORD
EMAIL_FROM=noreply@satelinkinternet.com
ALERT_EMAIL=ops@satelinkinternet.com

# ─── Admin & Security ────────────────────────────────────────
ADMIN_WALLET_ADDRESS=REPLACE_WITH_ADMIN_WALLET_ADDRESS
CORS_ORIGINS=http://localhost:3000,https://app.satelinkinternet.com
RATE_LIMIT_WINDOW_MS=900000    # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100
HELMET_HSTS_MAX_AGE=31536000

# ─── Edge Agent ───────────────────────────────────────────────
EDGE_AGENT_SECRET=REPLACE_WITH_EDGE_AGENT_HMAC_SECRET_REQUIRED
EDGE_AGENT_API_URL=http://localhost:3001/api/edge
EDGE_AGENT_NODE_ID=           # Set automatically on first registration
EDGE_AGENT_WALLET=            # Embedded wallet address for this node

# ─── Monitoring & Observability ──────────────────────────────
SENTRY_DSN=                   # Optional: Sentry error tracking
PROMETHEUS_PORT=9090           # Optional: metrics endpoint
HEALTH_CHECK_SECRET=REPLACE_WITH_HEALTH_CHECK_SECRET

# ─── Feature Flags ────────────────────────────────────────────
FEATURE_REAL_SETTLEMENT=false  # Set true when Fuse contracts deployed
FEATURE_MOONPAY=false          # Set true when MoonPay integration tested
FEATURE_MULTI_CHAIN=false      # Future: Polygon/TRON
FEATURE_GOVERNANCE=false       # Set true when Timelock deployed
FEATURE_AGENT_CONTROL_CENTRE=true

# ─── Self-Test & Self-Heal ────────────────────────────────────
SELF_TEST_INTERVAL_MINUTES=5
SELF_HEAL_ENABLED=true
SAFE_MODE_ENABLED=true         # Auto-freeze withdrawals on monitor failure

# ─── VPS Node Deployment ─────────────────────────────────────
NODEOPS_BOOTSTRAP_FEE_USDT=50  # Bootstrap payment to provision VPS node
NODEOPS_API_KEY=               # NodeOps integration API key
NODEOPS_WEBHOOK_SECRET=REPLACE_WITH_NODEOPS_WEBHOOK_SECRET
